{"page_content": "Ask a question about your documents:\n>\n\n\nNext Steps\n\nYou now have a fully functional backend RAG pipeline. The next logical step would be to take the logic from query.py and integrate it into your src/core/chat_logic.py file so your Streamlit UI (from app.py and src/components/) can call it.\n```\n\nRAG Pipeline Integration & Technical Overview\n\nThis document outlines the integration of the Retrieval-Augmented Generation (RAG) system into the existing Invoice Parser to improve accuracy using historical data.\n\nCode Changes\n\nAI_parser/parser_helper.py\n\nImport Added: Imported repair_invoice_wrapper from AI_parser.invoice_repair_agent.\n\nLogic Injection: Modified process_single_invoice to pass the raw JSON extracted by Gemini into the repair_invoice_wrapper before returning it. This acts as a validation/correction layer.\n\nAI_parser/ai_core_parser.py\n\nImport Fix: Updated import statements to correctly reference the file path:\n\nChanged: from AI_parser_helper_function import ...\n\nTo: from AI_parser.parser_helper import ...\n\nRAG Pipeline Workflow\n\nThe pipeline operates in three distinct stages per invoice:\n\nExtraction (Standard): The system calls Gemini with the invoice file to extract initial raw JSON.\n\nRetrieval (Vector Search):\n\nThe Invoice Repair Agent takes the raw output and generates a vector embedding.\n\nIt queries the FAISS Vector Database to find the top 3 most semantically similar valid invoices from the historical dataset (e.g., same vendor, similar layout).\n\nRepair (Generative Fix):\n\nThe agent constructs a prompt containing: [Broken JSON] + [3 Valid Reference Invoices].\n\nGemini uses the references to correct typos, fix formatting issues, and validate math in the broken JSON.\n\nThe corrected JSON is returned to the main parser.\n\nBuilding the Vector Database\n\nThe Vector DB serves as the \"Long-Term Memory\" for the system. It must be built once before running the parser.\n\nPrerequisites:\n\ninvoices.csv must be present in the project root.", "metadata": {"source": "Internal Chatbot Knowledgebase", "type": "notion"}}